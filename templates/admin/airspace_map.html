<!--
/* * Nom de l'application : ATM-RDC
 * Description : Source file: airspace_map.html
 * Produit de : MOA Digital Agency, www.myoneart.com
 * Fait par : Aisance KALONJI, www.aisancekalonji.com
 * Auditer par : La CyberConfiance, www.cyberconfiance.com
 */
-->
{% extends "base.html" %}

{% block title %}Configuration Espace Aérien - ATM-RDC{% endblock %}
{% block page_title %}Configuration Espace Aérien{% endblock %}
{% block page_subtitle %}Définition de la zone de surveillance (RDC){% endblock %}

{% block head %}
<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
<!-- Leaflet Draw CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css"/>
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin/airspace_map.css') }}">
{% endblock %}

{% block content %}
<div class="bg-dark-400 rounded-xl border border-dark-100 overflow-hidden">
    <div class="p-6 border-b border-dark-100 flex justify-between items-center">
        <div>
            <h3 class="font-semibold text-white">
                <i class="fas fa-map-marked-alt mr-2 text-primary-400"></i>
                Carte Interactive
            </h3>
            <p class="text-sm text-gray-400 mt-1">
                Utilisez les outils de dessin pour définir les limites de l'espace aérien.
                Double-cliquez pour terminer un polygone.
            </p>
        </div>
        <div class="flex gap-2">
            <a href="{{ url_for('admin.settings') }}" class="px-4 py-2 bg-dark-300 text-gray-300 hover:text-white rounded-lg transition-colors">
                Retour
            </a>
            <button onclick="saveAirspace()" class="px-4 py-2 bg-primary-600 text-white hover:bg-primary-500 rounded-lg transition-colors flex items-center gap-2">
                <i class="fas fa-save"></i>
                Sauvegarder
            </button>
        </div>
    </div>

    <div class="p-4">
        <div id="map"></div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
<!-- Leaflet Draw JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>

<script>
    window.adminAirspaceContext = {
        existingGeoJSON: {{ geojson | tojson | safe if geojson else 'null' }},
        saveUrl: "{{ url_for('admin.save_airspace') }}",
        csrfToken: "{{ csrf_token() }}"
    };
</script>
<script src="{{ url_for('static', filename='js/admin/airspace_map.js') }}"></script>
{% endblock %}
