<!--
/* * Nom de l'application : ATM-RDC
 * Description : Source file: role_form.html
 * Produit de : MOA Digital Agency, www.myoneart.com
 * Fait par : Aisance KALONJI, www.aisancekalonji.com
 * Auditer par : La CyberConfiance, www.cyberconfiance.com
 */
-->
{% extends "base.html" %}

{% block title %}{% if role %}Modifier Rôle{% else %}Nouveau Rôle{% endif %}{% endblock %}
{% block page_title %}{% if role %}Modifier Rôle{% else %}Créer un Rôle{% endif %}{% endblock %}

{% block content %}
<div class="bg-dark-400 rounded-xl border border-dark-100 overflow-hidden max-w-4xl mx-auto">
    <form method="POST" class="p-6">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>

        <div class="mb-6">
            <label class="block text-sm font-medium text-white mb-2">Nom du rôle</label>
            <input type="text" name="name" value="{{ role.name if role else '' }}" required
                   class="w-full bg-dark-500 border border-dark-100 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-primary-500">
        </div>

        <div class="mb-6">
            <label class="block text-sm font-medium text-white mb-2">Description</label>
            <textarea name="description" rows="2"
                      class="w-full bg-dark-500 border border-dark-100 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-primary-500">{{ role.description if role else '' }}</textarea>
        </div>

        <div class="mb-6">
            <h4 class="text-white font-medium mb-4">Permissions</h4>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                {% for resource, perms in grouped_perms.items() %}
                <div class="bg-dark-500 p-4 rounded-lg border border-dark-100">
                    <h5 class="text-primary-400 font-bold uppercase text-sm mb-3 border-b border-dark-200 pb-2">{{ resource }}</h5>
                    <div class="space-y-2">
                        {% for perm in perms %}
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" name="permissions" value="{{ perm.id }}"
                                   {% if role and perm in role.permissions %}checked{% endif %}
                                   class="form-checkbox bg-dark-600 border-dark-200 text-primary-600 rounded">
                            <span class="text-gray-300 text-sm">{{ perm.action }}</span>
                            {% if perm.description %}
                            <span class="text-gray-600 text-xs">({{ perm.description }})</span>
                            {% endif %}
                        </label>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <div class="flex justify-end gap-4 mt-8">
            <a href="{{ url_for('admin.roles') }}" class="px-6 py-2 text-gray-400 hover:text-white">Annuler</a>
            <button type="submit" class="bg-primary-600 hover:bg-primary-700 text-white px-6 py-2 rounded-lg transition-colors">
                Enregistrer
            </button>
        </div>
    </form>
</div>
{% endblock %}
